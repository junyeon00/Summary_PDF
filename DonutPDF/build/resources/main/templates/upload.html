<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>PDF ì—…ë¡œë“œ</title>
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>
<!-- âœ… ê³µí†µ ë„¤ë¹„ê²Œì´ì…˜ë°” -->
<nav style="display: flex; justify-content: space-between; background-color: #f0f0f0; padding: 1rem;">
    <div><strong>DonutPDF</strong></div>
    <div>
        <a href="/mypage" style="margin-right: 1rem;">Mypage</a>
        <a href="/logout">Logout</a>
    </div>
</nav>

<main>
    <form id="upload-form" enctype="multipart/form-data">
        <h2>Upload and summarize PDF files</h2>
        <input type="file" name="file" id="file" accept="application/pdf" required />
        <button type="submit">Upload and Summary</button>
    </form>

    <!-- âœ… ìš”ì•½ ê²°ê³¼ë¥¼ ë³´ê¸° ì¢‹ê²Œ í‘œì‹œ -->
    <div id="upload-status" style="margin-top: 2rem; border: 1px solid #ccc; padding: 1rem; background-color: #fafafa;"></div>

    <!-- âœ… Chat íŽ˜ì´ì§€ ì´ë™ ë²„íŠ¼ -->
    <div style="margin-top: 2rem;">
        <a href="/chat">
            <button type="button">Go to Chat page</button>
        </a>
    </div>
</main>

<script>
    const uploadForm = document.getElementById('upload-form');
    const uploadStatus = document.getElementById('upload-status');

    uploadForm.addEventListener('submit', async (e) => {
        e.preventDefault();
        const formData = new FormData(uploadForm);
        uploadStatus.innerHTML = '<strong>Summarizing...</strong>';
        try {
            const res = await fetch('/api/summarizeFile', {
                method: 'POST',
                body: formData
            });
            const summary = await res.text();
            uploadStatus.innerHTML = `
                <h3>ðŸ“„ Summary results</h3>
                <div style="white-space: pre-wrap;">${summary}</div>
            `;
        } catch {
            uploadStatus.innerHTML = '<strong style="color: red;">summary failure</strong>';
        }
    });
</script>
</body>
</html>

